# Best Practices

## Summary

`ETTT` を利用してテストを行うためのベストプラクティスと思われる方法を説明します。  
導入の流れを順を説明します。  
このケースは、Webシステムの自動化ではなくバッチや、サーバレスが対象となる。

## 作業の流れ

1. 自動化したい動作・オペレーションを考える
1. コマンドの充足を洗い出す
1. 必要に応じてコマンドの実装を行う
1. 自動化する動作・オペレーションとその順序を整理する
1. 標準化シナリオを作成する
1. 個別シナリオを作成する
1. Suitesとして個別シナリオを管理するｓ

## 自動化したい動作・オペレーションを考える

まずは、自動化したいテストのオペレーションを洗い出す。  
この作業はテストを4つのPhaseで分割して考えることをオススメする。  
これは [Four-Phase Test](http://xunitpatterns.com/Four%20Phase%20Test.html) と呼ばれる手法を参考に行う。

|#|Phase|Description|
|:---|:---|:---|
|1|Setup|事前準備、前処理|
|2|Exercise|実行|
|3|Verify|検証、アサーション|
|4|Teardown|事後処理、後処理|

テストのオペレーションを上記のPhaseに分類して整理すること。  
例としては以下のようなものとなる。

|Operation|Description|Phase|
|:---|:---|:---|
|RDBレコード削除|RDBのレコードを削除する|Setup / Teardown|
|RDBレコード登録|RDBのレコードを登録する|Setup / Teardown|
|ディレクトリクリア|ファイルシステム上のディレクトリ内をクリア|Setup / Teardown|
|ファイル配置|ファイルシステム上のディレクトリへファイルを配置|Setup / Teardown|
|アプリケーション実行|試験対象のアプリケーションの実行|Exercise|
|ログ取得|試験対象のアプリケーションの出力ログを取得|Exercise|
|RDBレコード取得|RDBのレコードを取得する|Exercise|
|結果コード確認|実行したアプリケーションの終了コードを確認|Verify|
|RDBレコード確認|RDBのレコードを確認|Verify|
|ログ確認|ログを確認|Verify|

上記にてSetupとTeardownを同じオペレーションとして整理しているが、  
これはテストの組み方によって両方のPhaseで実行があり得るためとなる。  
全てのテストケースの先頭にクリアや削除処理を実施する場合と、  
全てのテストケースの最後にクリアや削除処理を実施する場合などがある。

また、[Assert](/pages/specification/assert.md) でも説明した通りエビデンスの取得は `Verify` の前に実施する必要があるため、 `Exercise` として扱っている。


## コマンドの充足を洗い出す








